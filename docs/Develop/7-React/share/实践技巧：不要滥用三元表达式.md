# 实践技巧：不要滥用三元表达式

jsx 太灵活，可以使用三元表达式与 xml 混编，在代码量小的时候无所谓，但是当代码量大的时候，滥用三元表达式会造成 xml 结构混乱，请务必遵守以下原则：

-   如果三元表达式不能在一行内写完，请封装一个组件代替:

```javascript
//good
<div>{this.state.isRender?<Component/>:null}</div>

//good
const View = ({isHide=false,children})=>isHide?null:children;
...
<div>
	<View isHide={this.state.isRender}>
		<Component/>
	</View>
</div>

//bad
<div>{
	this.state.isRender?(
		<Component>
			<div></div>
			<p></p>
			<div></div>
		</Component>
	):null}
</div>

//good
const View = ({isHide=false,children})=>isHide?null:children;
...
<div>
	<View isHide={this.state.isRender}>
		<Component>
			<div></div>
			<p></p>
			<div></div>
		</Component>
	</View>
</div>
```

-   jsx 内的三元表达式禁止嵌套三元表达式 :

```javascript
render(){
	return (
		//bad
		<QueueAnim  duration="350">
			{this.store.loopPlayIsShow ? (
				<LoopPlay
					key="loopPlay"
					showPage={this.showPage}
					hide={this.loopPlayHide}
					{...this.loopPlay}
					wishes="私 人 访 谈<br>秀 出 <span>真 我</span>"
					btnText="预约访谈"
				/>
			) : (
				<div>
					{this.state.isPageShow ? (
						<div>
							<Page
								isLock={
									this.store.loopPlayIsShow ||
									this.store.modal.interviewForm ||
									this.store.modal.popbox
								}
							>
								<div id="interview">
									<QueueAnim
										duration="300"
									>
										{this.store.modal.popbox?
											<Confirm
												hide={this.modalHide}
											/>
										: null}
									</QueueAnim>
									<PageTop>
										<div
											className="introduce"
											onClick={this.loopPlayShow}
										>
											活动介绍
										</div>
										<div className="title">私人访谈</div>
										<div className="title-des">
											话筒灯光就位好，就等大神你来聊
										</div>
										<InterviewBtn
											gid={this.store.gid}
											typeChange={this.formTypeChange}
											show={this.modalShow}
											latestStatus={interviewList[0]}
										/>
									</PageTop>
									{length > 0 ? (
										interviewList.map((item, i) => (
											<InterviewRecord
												typeChange={this.formTypeChange}
												interviewState={item}
												key={item.id}
												selectId={item.id}
												firstRecord={i === 0}
												show={this.modalShow}
											/>
										))
									) : (
										<InterviewRecord firstRecord={true} />
									)}
									<LoadMore
										recordNum={length}
										hasMore={this.state.hasMore}
										getMore={this.getMoreRecord}
									/>
									<RulesTip title="注意事项" tips={this.tips} />
									<QueueAnim
										duration="300"
									>
										{this.store.modal.interviewForm?
											<div
												key="mask"
												className="interview-mask"
											/>
										: null}
									</QueueAnim>
								</div>
								<NavBar />
							</Page>
							<QueueAnim  duration="350">
								{this.store.modal.interviewForm?
									<InterviewForm
										key="form"
										hide={this.modalHide}
									/>
								: null}
							</QueueAnim>
						</div>
					) : null}
				</div>
			)}
		</QueueAnim>
	)
}
```
重构一下：
```javascript
//good
const View = ({isHide=false,children})=>isHide?null:children;
...

render(){
	return (
		<QueueAnim duration="350">
			<View isHide={!this.store.loopPlayIsShow}>
				<LoopPlay
					key="loopPlay"
					showPage={this.showPage}
					hide={this.loopPlayHide}
					{...this.loopPlay}
					wishes= "私 人 访 谈<br>秀 出 <span>真 我</span>"
					btnText="预约访谈"/>
			</View>
			<View isHide={this.store.loopPlayIsShow}>
				<div>
					<View isHide={!this.state.isPageShow}>
						<div>
							<Page isLock={this.store.loopPlayIsShow || this.store.modal.interviewForm || this.store.modal.popbox}>
								<div id="interview">
									<QueueAnim duration="300">
										{this.store.modal.popbox ?<Confirm hide={this.modalHide}/>:null}
									</QueueAnim>

									<PageTop>
										<div className="introduce" onClick={this.loopPlayShow}>
											活动介绍
										</div>
										<div className="title">私人访谈</div>
										<div className="title-des">话筒灯光就位好，就等大神你来聊</div>
										<InterviewBtn
											gid={this.store.gid}
											typeChange={this.formTypeChange}
											show={this.modalShow}
											latestStatus={interviewList[0]}
										/>
									</PageTop>

									<View isHide={length>0}>
										{interviewList.map((item,i) =>
											<InterviewRecord
												typeChange={this.formTypeChange}
												interviewState={item}
												key={item.id}
												selectId={item.id}
												firstRecord={i === 0}
												show={this.modalShow}
											/>
										)}
									</View>

									<View isHide={length<0}>
										<InterviewRecord firstRecord={true}/>
									</View>

									<LoadMore
										recordNum={length}
										hasMore={this.state.hasMore}
										getMore={this.getMoreRecord}
									/>

									<RulesTip title="注意事项" tips={this.tips}/>

									<QueueAnim duration="300">
										{this.store.modal.interviewForm ?<div key="mask" className="interview-mask"/> :null}
									</QueueAnim>
								</div>
							</Page>
						</div>
					</View>
				</div>
			</View>
		</QueueAnim>
	)
}
```

> 上面的是 vip 社区项目内的代码，可以看见不用三元表达式之后，结构清晰了很多。但是代码还是有些长，一些大段条件渲染还可以拆分出去成为部件，减少阅读复杂度。
